<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui" xmlns:h="http://java.sun.com/jsf/html"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                template="/index.xhtml">

    <ui:define  name="content">

        <!-- filtrado-->
        <br/>
        <h:inputText id="inputAllAttributes" value="#{cliente.by_all_attributes}">
            <p:ajax event="valueChange" update="tabla_clientes page" listener="#{cliente.resetPage}"/>
        </h:inputText>
        <p:watermark value="Filtro completo" for="inputAllAttributes" />
        <br/><br/>

        <h:inputText id="inputNombre" value="#{cliente.by_nombre}" >
            <p:ajax event="valueChange" update="tabla_clientes page" listener="#{cliente.resetPage}"/>
        </h:inputText>
        <p:watermark value="Nombre" for="inputNombre" />

        <h:inputText id="inputCedula" value="#{cliente.by_cedula}" >
            <p:ajax event="valueChange" update="tabla_clientes page" listener="#{cliente.resetPage}"/>
        </h:inputText>
        <p:watermark value="Cedula" for="inputCedula" />
        <br/><br/>
        raw

        <!-- tabla de datos-->
        <p:dataTable id="tabla_clientes"
                     value="#{cliente.clientes}" rowIndexVar="index" var="cli" emptyMessage="No se encuentran registros">

            <f:facet name="header">
                Lista de clientes
            </f:facet>

            <p:column>
                <f:facet name="header">Nombre</f:facet>
                #{cli.nombre}
            </p:column>

            <p:column>
                <f:facet name="header">Cedula</f:facet>
                #{cli.cedulaIdentidad}
            </p:column>
            <p:column style="width:32px;text-align: center">
                <p:commandButton style="height:25px" update=":form:editClienteForm" oncomplete="PF('modificarCliente').show()" icon="ui-icon-search" >
                    <f:setPropertyActionListener value="#{cli}" target="#{cliente.selectedCliente}" />
                </p:commandButton>
            </p:column>

        </p:dataTable>

        <!-- paginacion-->
        <br/>
        <h:panelGrid columns="3" style="align-content: center;padding-left:90%" >
            <p:commandButton style="height: 25px;" icon="ui-icon-arrow-1-w" actionListener="#{cliente.goBackPage}" update="page tabla_clientes"/>
                <h:outputText style="height: 25px;" id="page" value=" #{cliente.page} of #{cliente.totalPages} " />
            <p:commandButton style="height: 25px;" icon="ui-icon-arrow-1-e" actionListener="#{cliente.goNextPage}" update="page tabla_clientes"/>
        </h:panelGrid>

        <br />
        <!-- BTN AÑADIR CLIENTE - POPUP-->
        <p:commandButton id="newCliente" update="tabla_clientes" value="Añadir Cliente" oncomplete="PF('createCliente').show()"  />
        <ui:include src="abm.xhtml" />

        <!-- BTN MODIFICAR CLIENTE - POPUP-->
        <h:form id="editClienteForm">
           <p:dialog widgetVar="modificarCliente" closable="false" id="modificar_cliente" header="Modificar cliente" resizable="false" >

                <h:panelGrid id="formEditCliente"  columns="3" style="width:100%;">
                    <p:outputLabel value="Nombre" />
                    <p:inputText  value="#{cliente.nombreModificar}" placeholder="#{cliente.selectedCliente.nombre}"
                                  id="nombreEditCliente" maxlength="50" style="width:100%;height:100%"
                                  requiredMessage="Describa un nombre " >
                    </p:inputText>
                    <p:messages style="margin-left: 15px;" for="nombreEditCliente" />

                    <p:outputLabel value="Nro. Documento" />
                    <p:inputText value="#{cliente.cedulaModificar}"  placeholder="#{cliente.selectedCliente.cedulaIdentidad}"
                                 id="documentoEditCliente" maxlength="50" style="width:100%;height:100%"
                                 requiredMessage="Describa el documento" >
                    </p:inputText>
                    <p:messages style="margin-left: 15px;" for="documentoEditCliente" />
                </h:panelGrid>

                <br />
                <p:commandButton process="editClienteForm" value="Guardar" oncomplete="if(!args.validationFailed){PF('modificarCliente').hide()}"
                                 update=":messages :form:tabla_clientes" actionListener="#{cliente.doEditarCliente}" />

                <p:commandButton process="@this formEditCliente"  immediate="true" oncomplete="PF('modificarCliente').hide()" value="Cancelar"
                                 update="formEditCliente" actionListener="#{cliente.resetCampos}"  />
           </p:dialog>
        </h:form>
    </ui:define>

</ui:composition>